---
title: "Task_3"
author: "Robert_Nagy"
format: html
editor: visual
---

```{r}

# -----------------------------
# 1. Load required libraries
# -----------------------------
library(dplyr)
library(readr)
library(readxl)

# -----------------------------
# 2. Import the dataset
# -----------------------------
my_real_data <- read_excel("Sweden_task3.xlsx")

# -----------------------------
# 3. First inspection of data
# -----------------------------
glimpse(my_real_data)       # Structure and data types
head(my_real_data)          # First 6 rows
summary(my_real_data)       # Summary statistics

############################################################
# 4. Data Exploration â€“ 5 Questions using dplyr
############################################################

# ----------------------------------------------------------
# QUESTION 1:
# Which 10 cities have the highest population?
# ----------------------------------------------------------
my_real_data %>%
  select(city, population) %>%
  arrange(desc(population)) %>%
  head(10)

# ----------------------------------------------------------
# QUESTION 2:
# What is the average population for each capital type?
# (capital = primary, admin, minor, NA)
# ----------------------------------------------------------
my_real_data %>%
  group_by(capital) %>%
  summarise(
    avg_population = mean(population, na.rm = TRUE),
    count = n()
  )

# ----------------------------------------------------------
# QUESTION 3:
# Filter cities with a population greater than 200,000.
# ----------------------------------------------------------
my_real_data %>%
  filter(population > 200000) %>%
  select(city, population, admin_name)

# ----------------------------------------------------------
# QUESTION 4:
# Create a new column showing the difference between
# population and population_proper.
# ----------------------------------------------------------
my_real_data %>%
  mutate(population_diff = population - population_proper) %>%
  select(city, population, population_proper, population_diff)

# ----------------------------------------------------------
# QUESTION 5:
# Which administrative regions have the largest
# total population (sum of all cities)?
# ----------------------------------------------------------
my_real_data %>%
  group_by(admin_name) %>%
  summarise(total_population = sum(population, na.rm = TRUE)) %>%
  arrange(desc(total_population))
```

