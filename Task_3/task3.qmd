---
title: "Task_3"
author: "Robert_Nagy"
format: html
editor: visual
---

```{r}
############################################################
# TASK 3 – Expanding Your Universe
# Real-world dataset exploration using dplyr
# Dataset used: Sweden_task3.xlsx
# Source: (uploaded dataset provided by student)
############################################################

# -----------------------------
# 1. Load required libraries
# -----------------------------
library(dplyr)
library(readr)
library(readxl)

# -----------------------------
# 2. Import the dataset
# -----------------------------
my_real_data <- read_excel("Sweden_task3.xlsx")

# -----------------------------
# 3. First inspection of data
# -----------------------------
glimpse(my_real_data)       # Structure and data types
head(my_real_data)          # First 6 rows
summary(my_real_data)       # Summary statistics

############################################################
# 4. Data Exploration – 5 Questions using dplyr
############################################################

# ----------------------------------------------------------
# QUESTION 1:
# Which 10 cities have the highest population?
# ----------------------------------------------------------
my_real_data %>%
  select(city, population) %>%
  arrange(desc(population)) %>%
  head(10)

# ----------------------------------------------------------
# QUESTION 2:
# What is the average population for each capital type?
# (capital = primary, admin, minor, NA)
# ----------------------------------------------------------
my_real_data %>%
  group_by(capital) %>%
  summarise(
    avg_population = mean(population, na.rm = TRUE),
    count = n()
  )

# ----------------------------------------------------------
# QUESTION 3:
# Filter cities with a population greater than 200,000.
# ----------------------------------------------------------
my_real_data %>%
  filter(population > 200000) %>%
  select(city, population, admin_name)

# ----------------------------------------------------------
# QUESTION 4:
# Create a new column showing the difference between
# population and population_proper.
# ----------------------------------------------------------
my_real_data %>%
  mutate(population_diff = population - population_proper) %>%
  select(city, population, population_proper, population_diff)

# ----------------------------------------------------------
# QUESTION 5:
# Which administrative regions have the largest
# total population (sum of all cities)?
# ----------------------------------------------------------
my_real_data %>%
  group_by(admin_name) %>%
  summarise(total_population = sum(population, na.rm = TRUE)) %>%
  arrange(desc(total_population))
```

------------------------------------------------------------------------

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## Running Code

When you click the **Render** button a document will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
1 + 1
```

You can add options to executable code like this

```{r}
#| echo: false
2 * 2
```

The `echo: false` option disables the printing of code (only output is displayed).
